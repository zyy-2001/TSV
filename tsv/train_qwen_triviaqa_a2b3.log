Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 121/17944 [00:00<00:15, 1185.43 examples/s]Map:   1%|▏         | 254/17944 [00:00<00:14, 1261.29 examples/s]Map:   2%|▏         | 387/17944 [00:00<00:13, 1287.25 examples/s]Map:   3%|▎         | 520/17944 [00:00<00:13, 1298.92 examples/s]Map:   4%|▎         | 653/17944 [00:00<00:13, 1306.13 examples/s]Map:   4%|▍         | 786/17944 [00:00<00:13, 1311.58 examples/s]Map:   5%|▌         | 980/17944 [00:00<00:13, 1301.16 examples/s]Map:   6%|▌         | 1113/17944 [00:00<00:12, 1307.08 examples/s]Map:   7%|▋         | 1247/17944 [00:00<00:12, 1312.09 examples/s]Map:   8%|▊         | 1380/17944 [00:01<00:12, 1314.64 examples/s]Map:   8%|▊         | 1513/17944 [00:01<00:12, 1316.45 examples/s]Map:   9%|▉         | 1647/17944 [00:01<00:12, 1319.13 examples/s]Map:  10%|▉         | 1780/17944 [00:01<00:12, 1320.37 examples/s]Map:  11%|█         | 1913/17944 [00:01<00:12, 1321.03 examples/s]Map:  12%|█▏        | 2111/17944 [00:01<00:12, 1315.79 examples/s]Map:  13%|█▎        | 2245/17944 [00:01<00:11, 1318.05 examples/s]Map:  13%|█▎        | 2378/17944 [00:01<00:11, 1319.36 examples/s]Map:  14%|█▍        | 2511/17944 [00:01<00:11, 1320.09 examples/s]Map:  15%|█▌        | 2703/17944 [00:02<00:11, 1301.34 examples/s]Map:  16%|█▌        | 2837/17944 [00:02<00:11, 1307.67 examples/s]Map:  17%|█▋        | 2970/17944 [00:02<00:11, 1312.10 examples/s]Map:  17%|█▋        | 3103/17944 [00:02<00:11, 1314.80 examples/s]Map:  18%|█▊        | 3300/17944 [00:02<00:11, 1310.36 examples/s]Map:  19%|█▉        | 3433/17944 [00:02<00:11, 1312.47 examples/s]Map:  20%|█▉        | 3567/17944 [00:02<00:10, 1316.20 examples/s]Map:  21%|██        | 3701/17944 [00:02<00:10, 1318.46 examples/s]Map:  22%|██▏       | 3895/17944 [00:02<00:10, 1305.45 examples/s]Map:  22%|██▏       | 4028/17944 [00:03<00:10, 1310.05 examples/s]Map:  23%|██▎       | 4161/17944 [00:03<00:10, 1313.59 examples/s]Map:  24%|██▍       | 4294/17944 [00:03<00:10, 1316.46 examples/s]Map:  25%|██▍       | 4426/17944 [00:03<00:10, 1313.85 examples/s]Map:  25%|██▌       | 4559/17944 [00:03<00:10, 1316.66 examples/s]Map:  26%|██▌       | 4693/17944 [00:03<00:10, 1319.30 examples/s]Map:  27%|██▋       | 4827/17944 [00:03<00:09, 1320.97 examples/s]Map:  28%|██▊       | 5024/17944 [00:03<00:09, 1314.58 examples/s]Map:  29%|██▊       | 5156/17944 [00:03<00:09, 1314.08 examples/s]Map:  29%|██▉       | 5289/17944 [00:04<00:09, 1316.65 examples/s]Map:  30%|███       | 5423/17944 [00:04<00:09, 1319.21 examples/s]Map:  31%|███▏      | 5622/17944 [00:04<00:09, 1318.89 examples/s]Map:  32%|███▏      | 5755/17944 [00:04<00:09, 1320.27 examples/s]Map:  33%|███▎      | 5889/17944 [00:04<00:09, 1321.91 examples/s]Map:  34%|███▎      | 6023/17944 [00:04<00:09, 1322.60 examples/s]Map:  34%|███▍      | 6157/17944 [00:04<00:08, 1323.31 examples/s]Map:  35%|███▌      | 6348/17944 [00:04<00:08, 1299.83 examples/s]Map:  36%|███▌      | 6481/17944 [00:04<00:08, 1305.98 examples/s]Map:  37%|███▋      | 6614/17944 [00:05<00:08, 1311.04 examples/s]Map:  38%|███▊      | 6748/17944 [00:05<00:08, 1316.35 examples/s]Map:  38%|███▊      | 6882/17944 [00:05<00:08, 1318.72 examples/s]Map:  39%|███▉      | 7015/17944 [00:05<00:08, 1319.49 examples/s]Map:  40%|███▉      | 7149/17944 [00:05<00:08, 1321.50 examples/s]Map:  41%|████      | 7345/17944 [00:05<00:08, 1313.75 examples/s]Map:  42%|████▏     | 7543/17944 [00:05<00:07, 1314.33 examples/s]Map:  43%|████▎     | 7676/17944 [00:05<00:07, 1316.20 examples/s]Map:  44%|████▎     | 7810/17944 [00:05<00:07, 1318.64 examples/s]Map:  44%|████▍     | 7943/17944 [00:06<00:07, 1319.62 examples/s]Map:  45%|████▌     | 8076/17944 [00:06<00:07, 1320.92 examples/s]Map:  46%|████▌     | 8210/17944 [00:06<00:07, 1323.86 examples/s]Map:  47%|████▋     | 8344/17944 [00:06<00:07, 1326.48 examples/s]Map:  47%|████▋     | 8478/17944 [00:06<00:07, 1327.96 examples/s]Map:  48%|████▊     | 8673/17944 [00:06<00:07, 1311.84 examples/s]Map:  49%|████▉     | 8806/17944 [00:06<00:06, 1314.25 examples/s]Map:  50%|████▉     | 8939/17944 [00:06<00:06, 1316.50 examples/s]Map:  51%|█████     | 9073/17944 [00:06<00:06, 1319.40 examples/s]Map:  51%|█████▏    | 9206/17944 [00:07<00:06, 1320.49 examples/s]Map:  52%|█████▏    | 9340/17944 [00:07<00:06, 1320.97 examples/s]Map:  53%|█████▎    | 9473/17944 [00:07<00:06, 1321.12 examples/s]Map:  54%|█████▎    | 9607/17944 [00:07<00:06, 1322.54 examples/s]Map:  54%|█████▍    | 9740/17944 [00:07<00:06, 1320.30 examples/s]Map:  55%|█████▌    | 9935/17944 [00:07<00:06, 1309.15 examples/s]Map:  65%|██████▌   | 11697/17944 [00:07<00:01, 5690.68 examples/s]Map:  77%|███████▋  | 13743/17944 [00:07<00:00, 9784.95 examples/s]Map:  88%|████████▊ | 15727/17944 [00:07<00:00, 12635.98 examples/s]Map:  99%|█████████▊| 17716/17944 [00:07<00:00, 14726.17 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2198.26 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

