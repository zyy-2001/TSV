Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 104/17944 [00:00<00:17, 1022.81 examples/s]Map:   1%|          | 221/17944 [00:00<00:16, 1106.53 examples/s]Map:   2%|▏         | 350/17944 [00:00<00:14, 1184.94 examples/s]Map:   3%|▎         | 478/17944 [00:00<00:14, 1220.24 examples/s]Map:   3%|▎         | 607/17944 [00:00<00:13, 1242.75 examples/s]Map:   4%|▍         | 737/17944 [00:00<00:13, 1257.71 examples/s]Map:   5%|▍         | 867/17944 [00:00<00:13, 1266.57 examples/s]Map:   6%|▌         | 996/17944 [00:00<00:13, 1271.90 examples/s]Map:   6%|▋         | 1125/17944 [00:00<00:13, 1275.73 examples/s]Map:   7%|▋         | 1255/17944 [00:01<00:13, 1280.10 examples/s]Map:   8%|▊         | 1385/17944 [00:01<00:12, 1282.73 examples/s]Map:   8%|▊         | 1514/17944 [00:01<00:12, 1283.65 examples/s]Map:   9%|▉         | 1643/17944 [00:01<00:12, 1284.36 examples/s]Map:  10%|▉         | 1773/17944 [00:01<00:12, 1285.99 examples/s]Map:  11%|█         | 1903/17944 [00:01<00:12, 1287.41 examples/s]Map:  11%|█▏        | 2032/17944 [00:01<00:12, 1287.28 examples/s]Map:  12%|█▏        | 2162/17944 [00:01<00:12, 1286.00 examples/s]Map:  13%|█▎        | 2292/17944 [00:01<00:12, 1286.05 examples/s]Map:  13%|█▎        | 2422/17944 [00:01<00:12, 1285.60 examples/s]Map:  14%|█▍        | 2552/17944 [00:02<00:11, 1286.11 examples/s]Map:  15%|█▍        | 2681/17944 [00:02<00:11, 1286.46 examples/s]Map:  16%|█▌        | 2872/17944 [00:02<00:11, 1278.29 examples/s]Map:  17%|█▋        | 3002/17944 [00:02<00:11, 1280.55 examples/s]Map:  17%|█▋        | 3132/17944 [00:02<00:11, 1281.62 examples/s]Map:  18%|█▊        | 3262/17944 [00:02<00:11, 1283.69 examples/s]Map:  19%|█▉        | 3392/17944 [00:02<00:11, 1286.07 examples/s]Map:  20%|█▉        | 3521/17944 [00:02<00:11, 1286.50 examples/s]Map:  21%|██        | 3714/17944 [00:02<00:11, 1284.09 examples/s]Map:  21%|██▏       | 3844/17944 [00:03<00:10, 1286.10 examples/s]Map:  22%|██▏       | 3974/17944 [00:03<00:10, 1288.41 examples/s]Map:  23%|██▎       | 4168/17944 [00:03<00:10, 1285.37 examples/s]Map:  24%|██▍       | 4299/17944 [00:03<00:10, 1288.46 examples/s]Map:  25%|██▍       | 4430/17944 [00:03<00:10, 1290.79 examples/s]Map:  25%|██▌       | 4561/17944 [00:03<00:10, 1292.39 examples/s]Map:  26%|██▌       | 4691/17944 [00:03<00:10, 1294.15 examples/s]Map:  27%|██▋       | 4821/17944 [00:03<00:10, 1293.41 examples/s]Map:  28%|██▊       | 5015/17944 [00:03<00:10, 1289.47 examples/s]Map:  29%|██▊       | 5146/17944 [00:04<00:09, 1292.15 examples/s]Map:  29%|██▉       | 5278/17944 [00:04<00:09, 1295.26 examples/s]Map:  30%|███       | 5409/17944 [00:04<00:09, 1297.59 examples/s]Map:  31%|███       | 5602/17944 [00:04<00:09, 1290.85 examples/s]Map:  32%|███▏      | 5733/17944 [00:04<00:09, 1291.85 examples/s]Map:  33%|███▎      | 5864/17944 [00:04<00:09, 1294.20 examples/s]Map:  33%|███▎      | 5994/17944 [00:04<00:09, 1293.68 examples/s]Map:  34%|███▍      | 6124/17944 [00:04<00:09, 1292.61 examples/s]Map:  35%|███▍      | 6255/17944 [00:04<00:09, 1294.99 examples/s]Map:  36%|███▌      | 6447/17944 [00:05<00:08, 1286.12 examples/s]Map:  37%|███▋      | 6577/17944 [00:05<00:08, 1288.15 examples/s]Map:  37%|███▋      | 6707/17944 [00:05<00:08, 1290.15 examples/s]Map:  38%|███▊      | 6838/17944 [00:05<00:08, 1291.99 examples/s]Map:  39%|███▉      | 6969/17944 [00:05<00:08, 1294.39 examples/s]Map:  40%|███▉      | 7100/17944 [00:05<00:08, 1294.34 examples/s]Map:  41%|████      | 7292/17944 [00:05<00:08, 1282.54 examples/s]Map:  41%|████▏     | 7421/17944 [00:05<00:08, 1282.70 examples/s]Map:  42%|████▏     | 7551/17944 [00:05<00:08, 1284.46 examples/s]Map:  43%|████▎     | 7740/17944 [00:06<00:08, 1269.80 examples/s]Map:  44%|████▍     | 7871/17944 [00:06<00:07, 1277.08 examples/s]Map:  45%|████▍     | 8002/17944 [00:06<00:07, 1282.59 examples/s]Map:  45%|████▌     | 8133/17944 [00:06<00:07, 1286.26 examples/s]Map:  46%|████▌     | 8263/17944 [00:06<00:07, 1288.87 examples/s]Map:  47%|████▋     | 8394/17944 [00:06<00:07, 1292.04 examples/s]Map:  48%|████▊     | 8586/17944 [00:06<00:07, 1284.09 examples/s]Map:  49%|████▊     | 8717/17944 [00:06<00:07, 1289.04 examples/s]Map:  49%|████▉     | 8849/17944 [00:06<00:07, 1294.01 examples/s]Map:  50%|█████     | 8981/17944 [00:07<00:06, 1297.16 examples/s]Map:  51%|█████     | 9112/17944 [00:07<00:06, 1298.99 examples/s]Map:  52%|█████▏    | 9243/17944 [00:07<00:06, 1300.30 examples/s]Map:  52%|█████▏    | 9375/17944 [00:07<00:06, 1301.99 examples/s]Map:  53%|█████▎    | 9506/17944 [00:07<00:06, 1299.80 examples/s]Map:  54%|█████▍    | 9702/17944 [00:07<00:06, 1300.30 examples/s]Map:  55%|█████▍    | 9833/17944 [00:07<00:06, 1298.81 examples/s]Map:  56%|█████▋    | 10138/17944 [00:07<00:04, 1782.44 examples/s]Map:  67%|██████▋   | 12095/17944 [00:07<00:00, 6816.78 examples/s]Map:  79%|███████▊  | 14093/17944 [00:07<00:00, 10604.74 examples/s]Map:  89%|████████▉ | 16019/17944 [00:08<00:00, 13124.95 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 14863.30 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2147.92 examples/s] 
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.35s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.30s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.29s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:04<00:01,  1.40s/it]
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3903, in from_pretrained
    ) = cls._load_pretrained_model(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 4377, in _load_pretrained_model
    new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 933, in _load_state_dict_into_meta_model
    set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 298, in set_module_tensor_to_device
    new_value = value.to(device)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 130.00 MiB. GPU 
