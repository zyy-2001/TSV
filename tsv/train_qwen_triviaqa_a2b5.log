Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 122/17944 [00:00<00:14, 1195.08 examples/s]Map:   1%|▏         | 252/17944 [00:00<00:14, 1249.89 examples/s]Map:   2%|▏         | 443/17944 [00:00<00:13, 1255.90 examples/s]Map:   3%|▎         | 574/17944 [00:00<00:13, 1269.92 examples/s]Map:   4%|▍         | 705/17944 [00:00<00:13, 1280.29 examples/s]Map:   5%|▍         | 836/17944 [00:00<00:13, 1286.11 examples/s]Map:   5%|▌         | 967/17944 [00:00<00:13, 1290.06 examples/s]Map:   6%|▌         | 1098/17944 [00:00<00:13, 1292.13 examples/s]Map:   7%|▋         | 1229/17944 [00:00<00:12, 1294.17 examples/s]Map:   8%|▊         | 1360/17944 [00:01<00:12, 1295.67 examples/s]Map:   8%|▊         | 1492/17944 [00:01<00:12, 1298.39 examples/s]Map:   9%|▉         | 1622/17944 [00:01<00:12, 1295.10 examples/s]Map:  10%|▉         | 1753/17944 [00:01<00:12, 1296.61 examples/s]Map:  11%|█         | 1885/17944 [00:01<00:12, 1298.91 examples/s]Map:  11%|█         | 2017/17944 [00:01<00:12, 1300.15 examples/s]Map:  12%|█▏        | 2148/17944 [00:01<00:12, 1299.62 examples/s]Map:  13%|█▎        | 2280/17944 [00:01<00:12, 1300.35 examples/s]Map:  13%|█▎        | 2412/17944 [00:01<00:11, 1301.93 examples/s]Map:  14%|█▍        | 2543/17944 [00:01<00:11, 1301.90 examples/s]Map:  15%|█▍        | 2674/17944 [00:02<00:11, 1301.78 examples/s]Map:  16%|█▌        | 2870/17944 [00:02<00:11, 1298.61 examples/s]Map:  17%|█▋        | 3001/17944 [00:02<00:11, 1299.19 examples/s]Map:  17%|█▋        | 3132/17944 [00:02<00:11, 1299.83 examples/s]Map:  19%|█▊        | 3327/17944 [00:02<00:11, 1293.60 examples/s]Map:  19%|█▉        | 3458/17944 [00:02<00:11, 1295.14 examples/s]Map:  20%|██        | 3590/17944 [00:02<00:11, 1298.18 examples/s]Map:  21%|██        | 3722/17944 [00:02<00:10, 1300.49 examples/s]Map:  21%|██▏       | 3853/17944 [00:02<00:10, 1300.61 examples/s]Map:  23%|██▎       | 4049/17944 [00:03<00:10, 1298.78 examples/s]Map:  23%|██▎       | 4181/17944 [00:03<00:10, 1300.36 examples/s]Map:  24%|██▍       | 4313/17944 [00:03<00:10, 1301.73 examples/s]Map:  25%|██▌       | 4509/17944 [00:03<00:10, 1298.84 examples/s]Map:  26%|██▌       | 4641/17944 [00:03<00:10, 1300.88 examples/s]Map:  27%|██▋       | 4773/17944 [00:03<00:10, 1302.96 examples/s]Map:  27%|██▋       | 4905/17944 [00:03<00:09, 1304.36 examples/s]Map:  28%|██▊       | 5098/17944 [00:03<00:09, 1296.39 examples/s]Map:  29%|██▉       | 5228/17944 [00:04<00:09, 1294.84 examples/s]Map:  30%|██▉       | 5360/17944 [00:04<00:09, 1298.23 examples/s]Map:  31%|███       | 5492/17944 [00:04<00:09, 1300.79 examples/s]Map:  32%|███▏      | 5688/17944 [00:04<00:09, 1299.15 examples/s]Map:  32%|███▏      | 5820/17944 [00:04<00:09, 1300.48 examples/s]Map:  33%|███▎      | 5951/17944 [00:04<00:09, 1301.41 examples/s]Map:  34%|███▍      | 6082/17944 [00:04<00:09, 1302.15 examples/s]Map:  35%|███▍      | 6213/17944 [00:04<00:09, 1301.48 examples/s]Map:  36%|███▌      | 6406/17944 [00:04<00:08, 1291.81 examples/s]Map:  36%|███▋      | 6537/17944 [00:05<00:08, 1293.77 examples/s]Map:  37%|███▋      | 6669/17944 [00:05<00:08, 1297.44 examples/s]Map:  38%|███▊      | 6800/17944 [00:05<00:08, 1299.05 examples/s]Map:  39%|███▊      | 6932/17944 [00:05<00:08, 1301.75 examples/s]Map:  39%|███▉      | 7064/17944 [00:05<00:08, 1303.74 examples/s]Map:  40%|████      | 7196/17944 [00:05<00:08, 1305.05 examples/s]Map:  41%|████      | 7388/17944 [00:05<00:08, 1291.40 examples/s]Map:  42%|████▏     | 7518/17944 [00:05<00:08, 1290.79 examples/s]Map:  43%|████▎     | 7649/17944 [00:05<00:07, 1294.19 examples/s]Map:  43%|████▎     | 7780/17944 [00:06<00:07, 1296.81 examples/s]Map:  44%|████▍     | 7911/17944 [00:06<00:07, 1298.96 examples/s]Map:  45%|████▍     | 8043/17944 [00:06<00:07, 1302.43 examples/s]Map:  46%|████▌     | 8174/17944 [00:06<00:07, 1301.89 examples/s]Map:  46%|████▋     | 8306/17944 [00:06<00:07, 1302.91 examples/s]Map:  47%|████▋     | 8438/17944 [00:06<00:07, 1303.87 examples/s]Map:  48%|████▊     | 8631/17944 [00:06<00:07, 1291.99 examples/s]Map:  49%|████▉     | 8762/17944 [00:06<00:07, 1294.38 examples/s]Map:  50%|████▉     | 8894/17944 [00:06<00:06, 1297.57 examples/s]Map:  50%|█████     | 9026/17944 [00:06<00:06, 1299.40 examples/s]Map:  51%|█████     | 9158/17944 [00:07<00:06, 1301.07 examples/s]Map:  52%|█████▏    | 9290/17944 [00:07<00:06, 1301.92 examples/s]Map:  53%|█████▎    | 9421/17944 [00:07<00:06, 1302.37 examples/s]Map:  53%|█████▎    | 9553/17944 [00:07<00:06, 1303.47 examples/s]Map:  54%|█████▍    | 9745/17944 [00:07<00:06, 1292.32 examples/s]Map:  55%|█████▌    | 9876/17944 [00:07<00:06, 1295.10 examples/s]Map:  60%|██████    | 10805/17944 [00:07<00:02, 3507.80 examples/s]Map:  71%|███████▏  | 12816/17944 [00:07<00:00, 8210.68 examples/s]Map:  82%|████████▏ | 14801/17944 [00:07<00:00, 11564.11 examples/s]Map:  94%|█████████▍| 16839/17944 [00:08<00:00, 14105.10 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2171.35 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

