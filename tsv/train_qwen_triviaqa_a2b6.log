Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 120/17944 [00:00<00:15, 1178.05 examples/s]Map:   1%|▏         | 250/17944 [00:00<00:14, 1242.49 examples/s]Map:   2%|▏         | 380/17944 [00:00<00:13, 1265.72 examples/s]Map:   3%|▎         | 510/17944 [00:00<00:13, 1277.82 examples/s]Map:   4%|▎         | 641/17944 [00:00<00:13, 1286.28 examples/s]Map:   4%|▍         | 773/17944 [00:00<00:13, 1292.98 examples/s]Map:   5%|▌         | 903/17944 [00:00<00:13, 1290.63 examples/s]Map:   6%|▌         | 1034/17944 [00:00<00:13, 1293.82 examples/s]Map:   7%|▋         | 1229/17944 [00:00<00:12, 1290.59 examples/s]Map:   8%|▊         | 1361/17944 [00:01<00:12, 1294.86 examples/s]Map:   8%|▊         | 1493/17944 [00:01<00:12, 1298.67 examples/s]Map:   9%|▉         | 1625/17944 [00:01<00:12, 1301.76 examples/s]Map:  10%|▉         | 1757/17944 [00:01<00:12, 1302.65 examples/s]Map:  11%|█         | 1889/17944 [00:01<00:12, 1303.85 examples/s]Map:  11%|█▏        | 2020/17944 [00:01<00:12, 1301.96 examples/s]Map:  12%|█▏        | 2212/17944 [00:01<00:12, 1291.55 examples/s]Map:  13%|█▎        | 2344/17944 [00:01<00:12, 1295.40 examples/s]Map:  14%|█▍        | 2476/17944 [00:01<00:11, 1297.82 examples/s]Map:  15%|█▍        | 2608/17944 [00:02<00:11, 1300.22 examples/s]Map:  15%|█▌        | 2739/17944 [00:02<00:11, 1300.63 examples/s]Map:  16%|█▌        | 2871/17944 [00:02<00:11, 1302.04 examples/s]Map:  17%|█▋        | 3063/17944 [00:02<00:11, 1290.98 examples/s]Map:  18%|█▊        | 3194/17944 [00:02<00:11, 1294.11 examples/s]Map:  19%|█▉        | 3386/17944 [00:02<00:11, 1284.22 examples/s]Map:  20%|█▉        | 3517/17944 [00:02<00:11, 1288.74 examples/s]Map:  20%|██        | 3649/17944 [00:02<00:11, 1293.16 examples/s]Map:  21%|██        | 3781/17944 [00:02<00:10, 1297.53 examples/s]Map:  22%|██▏       | 3911/17944 [00:03<00:10, 1294.16 examples/s]Map:  23%|██▎       | 4043/17944 [00:03<00:10, 1297.37 examples/s]Map:  23%|██▎       | 4175/17944 [00:03<00:10, 1299.74 examples/s]Map:  24%|██▍       | 4371/17944 [00:03<00:10, 1299.90 examples/s]Map:  25%|██▌       | 4567/17944 [00:03<00:10, 1300.54 examples/s]Map:  26%|██▌       | 4699/17944 [00:03<00:10, 1303.22 examples/s]Map:  27%|██▋       | 4830/17944 [00:03<00:10, 1301.23 examples/s]Map:  28%|██▊       | 5026/17944 [00:03<00:09, 1301.40 examples/s]Map:  29%|██▊       | 5158/17944 [00:03<00:09, 1303.18 examples/s]Map:  29%|██▉       | 5290/17944 [00:04<00:09, 1305.01 examples/s]Map:  31%|███       | 5485/17944 [00:04<00:09, 1299.75 examples/s]Map:  31%|███▏      | 5616/17944 [00:04<00:09, 1300.93 examples/s]Map:  32%|███▏      | 5812/17944 [00:04<00:09, 1298.53 examples/s]Map:  33%|███▎      | 5944/17944 [00:04<00:09, 1299.96 examples/s]Map:  34%|███▍      | 6136/17944 [00:04<00:09, 1290.38 examples/s]Map:  35%|███▍      | 6267/17944 [00:04<00:09, 1292.63 examples/s]Map:  36%|███▌      | 6398/17944 [00:04<00:08, 1294.88 examples/s]Map:  36%|███▋      | 6530/17944 [00:05<00:08, 1298.06 examples/s]Map:  37%|███▋      | 6662/17944 [00:05<00:08, 1300.21 examples/s]Map:  38%|███▊      | 6794/17944 [00:05<00:08, 1301.60 examples/s]Map:  39%|███▉      | 6990/17944 [00:05<00:08, 1299.96 examples/s]Map:  40%|████      | 7184/17944 [00:05<00:08, 1293.63 examples/s]Map:  41%|████      | 7315/17944 [00:05<00:08, 1295.01 examples/s]Map:  41%|████▏     | 7446/17944 [00:05<00:08, 1296.21 examples/s]Map:  42%|████▏     | 7577/17944 [00:05<00:07, 1297.13 examples/s]Map:  43%|████▎     | 7709/17944 [00:05<00:07, 1299.41 examples/s]Map:  44%|████▍     | 7900/17944 [00:06<00:07, 1284.42 examples/s]Map:  45%|████▍     | 8030/17944 [00:06<00:07, 1286.63 examples/s]Map:  45%|████▌     | 8162/17944 [00:06<00:07, 1293.40 examples/s]Map:  47%|████▋     | 8357/17944 [00:06<00:07, 1291.00 examples/s]Map:  47%|████▋     | 8488/17944 [00:06<00:07, 1293.84 examples/s]Map:  48%|████▊     | 8620/17944 [00:06<00:07, 1298.49 examples/s]Map:  49%|████▉     | 8752/17944 [00:06<00:07, 1302.34 examples/s]Map:  50%|████▉     | 8884/17944 [00:06<00:06, 1303.50 examples/s]Map:  50%|█████     | 9016/17944 [00:06<00:06, 1304.41 examples/s]Map:  51%|█████▏    | 9210/17944 [00:07<00:06, 1295.57 examples/s]Map:  52%|█████▏    | 9342/17944 [00:07<00:06, 1298.34 examples/s]Map:  53%|█████▎    | 9474/17944 [00:07<00:06, 1301.52 examples/s]Map:  54%|█████▎    | 9606/17944 [00:07<00:06, 1303.57 examples/s]Map:  54%|█████▍    | 9738/17944 [00:07<00:06, 1304.46 examples/s]Map:  55%|█████▌    | 9870/17944 [00:07<00:06, 1305.82 examples/s]Map:  59%|█████▉    | 10652/17944 [00:07<00:02, 3201.33 examples/s]Map:  70%|███████   | 12639/17944 [00:07<00:00, 8099.11 examples/s]Map:  81%|████████▏ | 14598/17944 [00:07<00:00, 11495.96 examples/s]Map:  92%|█████████▏| 16538/17944 [00:08<00:00, 13840.56 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2167.48 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

