Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 121/17944 [00:00<00:15, 1180.04 examples/s]Map:   1%|▏         | 250/17944 [00:00<00:14, 1234.27 examples/s]Map:   2%|▏         | 378/17944 [00:00<00:14, 1252.89 examples/s]Map:   3%|▎         | 505/17944 [00:00<00:13, 1254.37 examples/s]Map:   4%|▎         | 634/17944 [00:00<00:13, 1262.57 examples/s]Map:   4%|▍         | 763/17944 [00:00<00:13, 1268.65 examples/s]Map:   5%|▍         | 892/17944 [00:00<00:13, 1273.51 examples/s]Map:   6%|▌         | 1021/17944 [00:00<00:13, 1275.68 examples/s]Map:   7%|▋         | 1212/17944 [00:00<00:13, 1268.17 examples/s]Map:   7%|▋         | 1341/17944 [00:01<00:13, 1272.92 examples/s]Map:   8%|▊         | 1470/17944 [00:01<00:12, 1275.77 examples/s]Map:   9%|▉         | 1600/17944 [00:01<00:12, 1278.05 examples/s]Map:  10%|▉         | 1791/17944 [00:01<00:12, 1274.77 examples/s]Map:  11%|█         | 1921/17944 [00:01<00:12, 1278.04 examples/s]Map:  11%|█▏        | 2051/17944 [00:01<00:12, 1280.48 examples/s]Map:  12%|█▏        | 2180/17944 [00:01<00:12, 1282.05 examples/s]Map:  13%|█▎        | 2310/17944 [00:01<00:12, 1283.51 examples/s]Map:  14%|█▍        | 2503/17944 [00:01<00:12, 1279.91 examples/s]Map:  15%|█▌        | 2696/17944 [00:02<00:11, 1280.70 examples/s]Map:  16%|█▌        | 2889/17944 [00:02<00:11, 1280.04 examples/s]Map:  17%|█▋        | 3019/17944 [00:02<00:11, 1281.56 examples/s]Map:  18%|█▊        | 3148/17944 [00:02<00:11, 1282.31 examples/s]Map:  19%|█▊        | 3336/17944 [00:02<00:11, 1268.65 examples/s]Map:  19%|█▉        | 3466/17944 [00:02<00:11, 1273.51 examples/s]Map:  20%|██        | 3596/17944 [00:02<00:11, 1277.58 examples/s]Map:  21%|██        | 3725/17944 [00:02<00:11, 1277.18 examples/s]Map:  21%|██▏       | 3854/17944 [00:03<00:11, 1278.00 examples/s]Map:  22%|██▏       | 3984/17944 [00:03<00:10, 1280.79 examples/s]Map:  23%|██▎       | 4114/17944 [00:03<00:10, 1282.37 examples/s]Map:  24%|██▎       | 4244/17944 [00:03<00:10, 1283.76 examples/s]Map:  25%|██▍       | 4437/17944 [00:03<00:10, 1281.36 examples/s]Map:  26%|██▌       | 4626/17944 [00:03<00:10, 1271.57 examples/s]Map:  27%|██▋       | 4756/17944 [00:03<00:10, 1276.54 examples/s]Map:  27%|██▋       | 4885/17944 [00:03<00:10, 1277.28 examples/s]Map:  28%|██▊       | 5013/17944 [00:03<00:10, 1275.36 examples/s]Map:  29%|██▉       | 5205/17944 [00:04<00:09, 1275.02 examples/s]Map:  30%|██▉       | 5335/17944 [00:04<00:09, 1278.50 examples/s]Map:  30%|███       | 5464/17944 [00:04<00:09, 1277.03 examples/s]Map:  31%|███       | 5594/17944 [00:04<00:09, 1281.33 examples/s]Map:  32%|███▏      | 5787/17944 [00:04<00:09, 1279.99 examples/s]Map:  33%|███▎      | 5917/17944 [00:04<00:09, 1283.21 examples/s]Map:  34%|███▎      | 6047/17944 [00:04<00:09, 1285.58 examples/s]Map:  35%|███▍      | 6239/17944 [00:04<00:09, 1279.09 examples/s]Map:  35%|███▌      | 6368/17944 [00:04<00:09, 1280.01 examples/s]Map:  37%|███▋      | 6561/17944 [00:05<00:08, 1278.66 examples/s]Map:  37%|███▋      | 6691/17944 [00:05<00:08, 1281.24 examples/s]Map:  38%|███▊      | 6820/17944 [00:05<00:08, 1279.53 examples/s]Map:  39%|███▊      | 6950/17944 [00:05<00:08, 1282.41 examples/s]Map:  39%|███▉      | 7079/17944 [00:05<00:08, 1283.68 examples/s]Map:  41%|████      | 7271/17944 [00:05<00:08, 1277.30 examples/s]Map:  41%|████      | 7401/17944 [00:05<00:08, 1280.05 examples/s]Map:  42%|████▏     | 7531/17944 [00:05<00:08, 1281.43 examples/s]Map:  43%|████▎     | 7660/17944 [00:05<00:08, 1282.47 examples/s]Map:  44%|████▍     | 7853/17944 [00:06<00:07, 1279.46 examples/s]Map:  45%|████▍     | 8045/17944 [00:06<00:07, 1275.25 examples/s]Map:  46%|████▌     | 8174/17944 [00:06<00:07, 1278.11 examples/s]Map:  46%|████▋     | 8304/17944 [00:06<00:07, 1280.10 examples/s]Map:  47%|████▋     | 8496/17944 [00:06<00:07, 1275.33 examples/s]Map:  48%|████▊     | 8625/17944 [00:06<00:07, 1277.37 examples/s]Map:  49%|████▉     | 8755/17944 [00:06<00:07, 1280.35 examples/s]Map:  50%|████▉     | 8885/17944 [00:06<00:07, 1283.66 examples/s]Map:  50%|█████     | 9015/17944 [00:07<00:06, 1284.39 examples/s]Map:  51%|█████▏    | 9207/17944 [00:07<00:06, 1278.26 examples/s]Map:  52%|█████▏    | 9336/17944 [00:07<00:06, 1280.62 examples/s]Map:  53%|█████▎    | 9466/17944 [00:07<00:06, 1283.52 examples/s]Map:  53%|█████▎    | 9596/17944 [00:07<00:06, 1284.88 examples/s]Map:  54%|█████▍    | 9726/17944 [00:07<00:06, 1285.53 examples/s]Map:  55%|█████▍    | 9856/17944 [00:07<00:06, 1286.99 examples/s]Map:  58%|█████▊    | 10442/17944 [00:07<00:02, 2615.57 examples/s]Map:  69%|██████▉   | 12354/17944 [00:07<00:00, 7463.05 examples/s]Map:  80%|███████▉  | 14321/17944 [00:08<00:00, 11070.71 examples/s]Map:  91%|█████████ | 16281/17944 [00:08<00:00, 13600.32 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2138.60 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

