Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.20s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.22s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.21s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
  0%|          | 0/817 [00:00<?, ?it/s] 19%|█▊        | 153/817 [00:00<00:00, 1523.58it/s] 39%|███▉      | 319/817 [00:00<00:00, 1602.63it/s] 59%|█████▉    | 484/817 [00:00<00:00, 1621.24it/s] 79%|███████▉  | 649/817 [00:00<00:00, 1631.84it/s]100%|█████████▉| 816/817 [00:00<00:00, 1643.72it/s]100%|██████████| 817/817 [00:00<00:00, 1627.31it/s]
Epoch 1/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
Epoch 1/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  1.10it/s]                                                                 epoch_loss: 0.6848214864730835
Epoch [1/20], Loss: 0.6848
Best test AUROC: 0.6667, at epoch: 0
Epoch [1/20],Test AUROC: 0.6667
Epoch 2/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 2/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.52it/s]                                                                 epoch_loss: 0.661128044128418
Epoch [2/20], Loss: 0.6611
Best test AUROC: 0.7091, at epoch: 1
Epoch [2/20],Test AUROC: 0.7091
Epoch 3/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 3/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]                                                                 epoch_loss: 0.6408376097679138
Epoch [3/20], Loss: 0.6408
Best test AUROC: 0.7410, at epoch: 2
Epoch [3/20],Test AUROC: 0.7410
Epoch 4/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 4/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.48it/s]                                                                 epoch_loss: 0.6191376447677612
Epoch [4/20], Loss: 0.6191
Best test AUROC: 0.7606, at epoch: 3
Epoch [4/20],Test AUROC: 0.7606
Epoch 5/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 5/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]                                                                 epoch_loss: 0.5991580486297607
Epoch [5/20], Loss: 0.5992
Best test AUROC: 0.7737, at epoch: 4
Epoch [5/20],Test AUROC: 0.7737
Epoch 6/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 6/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]                                                                 epoch_loss: 0.5772586464881897
Epoch [6/20], Loss: 0.5773
Best test AUROC: 0.7871, at epoch: 5
Epoch [6/20],Test AUROC: 0.7871
Epoch 7/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 7/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]                                                                 epoch_loss: 0.5507993698120117
Epoch [7/20], Loss: 0.5508
Best test AUROC: 0.7889, at epoch: 6
Epoch [7/20],Test AUROC: 0.7889
Epoch 8/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 8/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.49it/s]                                                                 epoch_loss: 0.5231736898422241
Epoch [8/20], Loss: 0.5232
Best test AUROC: 0.7955, at epoch: 7
Epoch [8/20],Test AUROC: 0.7955
Epoch 9/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 9/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.50it/s]                                                                 epoch_loss: 0.49496984481811523
Epoch [9/20], Loss: 0.4950
Best test AUROC: 0.8088, at epoch: 8
Epoch [9/20],Test AUROC: 0.8088
Epoch 10/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 10/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.49it/s]                                                                  epoch_loss: 0.47037041187286377
Epoch [10/20], Loss: 0.4704
Best test AUROC: 0.8138, at epoch: 9
Epoch [10/20],Test AUROC: 0.8138
Epoch 11/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 11/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.4461555778980255
Epoch [11/20], Loss: 0.4462
Best test AUROC: 0.8190, at epoch: 10
Epoch [11/20],Test AUROC: 0.8190
Epoch 12/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 12/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.49it/s]                                                                  epoch_loss: 0.42285072803497314
Epoch [12/20], Loss: 0.4229
Best test AUROC: 0.8269, at epoch: 11
Epoch [12/20],Test AUROC: 0.8269
Epoch 13/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 13/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.4010412096977234
Epoch [13/20], Loss: 0.4010
Best test AUROC: 0.8332, at epoch: 12
Epoch [13/20],Test AUROC: 0.8332
Epoch 14/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 14/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.37940144538879395
Epoch [14/20], Loss: 0.3794
Best test AUROC: 0.8371, at epoch: 13
Epoch [14/20],Test AUROC: 0.8371
Epoch 15/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 15/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.48it/s]                                                                  epoch_loss: 0.3599048852920532
Epoch [15/20], Loss: 0.3599
Best test AUROC: 0.8378, at epoch: 14
Epoch [15/20],Test AUROC: 0.8378
Epoch 16/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 16/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.48it/s]                                                                  epoch_loss: 0.34290412068367004
Epoch [16/20], Loss: 0.3429
Epoch [16/20],Test AUROC: 0.8364
Epoch 17/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 17/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.3245090842247009
Epoch [17/20], Loss: 0.3245
Epoch [17/20],Test AUROC: 0.8357
Epoch 18/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 18/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.3060011863708496
Epoch [18/20], Loss: 0.3060
Epoch [18/20],Test AUROC: 0.8343
Epoch 19/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 19/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.46it/s]                                                                  epoch_loss: 0.28845393657684326
Epoch [19/20], Loss: 0.2885
Epoch [19/20],Test AUROC: 0.8328
Epoch 20/20 Batches:   0%|          | 0/1 [00:00<?, ?it/s]Epoch 20/20 Batches: 100%|██████████| 1/1 [00:00<00:00,  2.47it/s]                                                                  epoch_loss: 0.2718445658683777
Epoch [20/20], Loss: 0.2718
Epoch [20/20],Test AUROC: 0.8319
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.09it/s] 50%|█████     | 2/4 [00:01<00:01,  1.04it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.08it/s]100%|██████████| 4/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.06it/s]
tsv_main.py:175: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  exemplar_label = torch.tensor(exemplar_labels).cuda()
tsv_main.py:182: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  augmented_labels = torch.concat((selected_labels, torch.tensor(exemplar_labels).clone().cuda()))
Epoch 1/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 1/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.45s/it]Epoch 1/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.20it/s]                                                                 epoch_loss: 0.1342211425304413
Epoch [1/20], Loss: 0.1342
Epoch 2/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 2/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 2/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.11305407881736755
Epoch [2/20], Loss: 0.1131
Epoch 3/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 3/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 3/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.09524182677268982
Epoch [3/20], Loss: 0.0952
Epoch 4/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 4/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 4/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.08136962056159973
Epoch [4/20], Loss: 0.0814
Epoch 5/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 5/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 5/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.06970564126968384
Epoch [5/20], Loss: 0.0697
Epoch 6/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 6/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 6/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.05979788899421692
Epoch [6/20], Loss: 0.0598
Epoch 7/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 7/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 7/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.05218348801136017
Epoch [7/20], Loss: 0.0522
Epoch 8/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 8/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 8/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.04556079357862473
Epoch [8/20], Loss: 0.0456
Best test AUROC: 0.8393, at epoch: 27
Epoch 9/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 9/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 9/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                 epoch_loss: 0.03961779922246933
Epoch [9/20], Loss: 0.0396
Best test AUROC: 0.8401, at epoch: 28
Epoch 10/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 10/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 10/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.03464276939630508
Epoch [10/20], Loss: 0.0346
Epoch 11/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 11/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 11/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.03042147159576416
Epoch [11/20], Loss: 0.0304
Epoch 12/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 12/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 12/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.026867809891700744
Epoch [12/20], Loss: 0.0269
Epoch 13/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 13/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 13/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.02394274026155472
Epoch [13/20], Loss: 0.0239
Epoch 14/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 14/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]Epoch 14/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.021452592313289644
Epoch [14/20], Loss: 0.0215
Epoch 15/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 15/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 15/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]                                                                  epoch_loss: 0.019371753185987474
Epoch [15/20], Loss: 0.0194
Epoch 16/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 16/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 16/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.18it/s]                                                                  epoch_loss: 0.017599983513355254
Epoch [16/20], Loss: 0.0176
Epoch 17/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 17/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 17/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.18it/s]                                                                  epoch_loss: 0.016091784089803697
Epoch [17/20], Loss: 0.0161
Epoch 18/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 18/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.48s/it]Epoch 18/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.18it/s]                                                                  epoch_loss: 0.0147666048258543
Epoch [18/20], Loss: 0.0148
Epoch 19/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 19/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 19/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.18it/s]                                                                  epoch_loss: 0.013608267158269882
Epoch [19/20], Loss: 0.0136
Epoch 20/20 Batches:   0%|          | 0/2 [00:00<?, ?it/s]/data/zyy/LLM/tsv/train_utils.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels, dtype=torch.long, device=device)
Epoch 20/20 Batches:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Epoch 20/20 Batches: 100%|██████████| 2/2 [00:01<00:00,  1.18it/s]                                                                  epoch_loss: 0.012587624415755273
Epoch [20/20], Loss: 0.0126
best_test_auroc: 0.8401290322580645
