Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   0%|          | 87/17944 [00:00<00:20, 855.06 examples/s]Map:   1%|          | 215/17944 [00:00<00:16, 1095.79 examples/s]Map:   2%|▏         | 343/17944 [00:00<00:14, 1174.45 examples/s]Map:   3%|▎         | 470/17944 [00:00<00:14, 1209.54 examples/s]Map:   4%|▎         | 651/17944 [00:00<00:14, 1203.38 examples/s]Map:   4%|▍         | 779/17944 [00:00<00:14, 1222.42 examples/s]Map:   5%|▌         | 907/17944 [00:00<00:13, 1237.08 examples/s]Map:   6%|▌         | 1035/17944 [00:00<00:13, 1247.73 examples/s]Map:   6%|▋         | 1162/17944 [00:00<00:13, 1252.64 examples/s]Map:   7%|▋         | 1290/17944 [00:01<00:13, 1257.89 examples/s]Map:   8%|▊         | 1419/17944 [00:01<00:13, 1262.86 examples/s]Map:   9%|▊         | 1547/17944 [00:01<00:12, 1267.34 examples/s]Map:   9%|▉         | 1676/17944 [00:01<00:12, 1268.52 examples/s]Map:  10%|█         | 1806/17944 [00:01<00:12, 1272.30 examples/s]Map:  11%|█         | 1935/17944 [00:01<00:12, 1274.09 examples/s]Map:  12%|█▏        | 2064/17944 [00:01<00:12, 1275.54 examples/s]Map:  12%|█▏        | 2193/17944 [00:01<00:12, 1276.51 examples/s]Map:  13%|█▎        | 2322/17944 [00:01<00:12, 1277.53 examples/s]Map:  14%|█▎        | 2450/17944 [00:01<00:12, 1275.22 examples/s]Map:  15%|█▍        | 2641/17944 [00:02<00:12, 1270.59 examples/s]Map:  15%|█▌        | 2769/17944 [00:02<00:11, 1269.90 examples/s]Map:  16%|█▌        | 2898/17944 [00:02<00:11, 1272.42 examples/s]Map:  17%|█▋        | 3027/17944 [00:02<00:11, 1273.02 examples/s]Map:  18%|█▊        | 3156/17944 [00:02<00:11, 1274.74 examples/s]Map:  19%|█▊        | 3347/17944 [00:02<00:11, 1269.14 examples/s]Map:  19%|█▉        | 3476/17944 [00:02<00:11, 1272.52 examples/s]Map:  20%|██        | 3605/17944 [00:02<00:11, 1274.63 examples/s]Map:  21%|██        | 3734/17944 [00:02<00:11, 1273.79 examples/s]Map:  22%|██▏       | 3863/17944 [00:03<00:11, 1274.51 examples/s]Map:  22%|██▏       | 3991/17944 [00:03<00:10, 1274.36 examples/s]Map:  23%|██▎       | 4119/17944 [00:03<00:10, 1274.99 examples/s]Map:  24%|██▎       | 4248/17944 [00:03<00:10, 1275.56 examples/s]Map:  24%|██▍       | 4377/17944 [00:03<00:10, 1276.95 examples/s]Map:  25%|██▌       | 4506/17944 [00:03<00:10, 1278.63 examples/s]Map:  26%|██▌       | 4635/17944 [00:03<00:10, 1279.15 examples/s]Map:  27%|██▋       | 4764/17944 [00:03<00:10, 1278.99 examples/s]Map:  27%|██▋       | 4892/17944 [00:03<00:10, 1276.91 examples/s]Map:  28%|██▊       | 5082/17944 [00:04<00:10, 1269.74 examples/s]Map:  29%|██▉       | 5210/17944 [00:04<00:10, 1271.00 examples/s]Map:  30%|██▉       | 5339/17944 [00:04<00:09, 1274.04 examples/s]Map:  30%|███       | 5468/17944 [00:04<00:09, 1275.74 examples/s]Map:  31%|███       | 5597/17944 [00:04<00:09, 1277.50 examples/s]Map:  32%|███▏      | 5725/17944 [00:04<00:09, 1275.27 examples/s]Map:  33%|███▎      | 5917/17944 [00:04<00:09, 1273.39 examples/s]Map:  34%|███▎      | 6046/17944 [00:04<00:09, 1274.27 examples/s]Map:  34%|███▍      | 6175/17944 [00:04<00:09, 1273.59 examples/s]Map:  35%|███▌      | 6304/17944 [00:04<00:09, 1273.69 examples/s]Map:  36%|███▌      | 6432/17944 [00:05<00:09, 1273.63 examples/s]Map:  37%|███▋      | 6560/17944 [00:05<00:08, 1274.48 examples/s]Map:  37%|███▋      | 6688/17944 [00:05<00:08, 1272.77 examples/s]Map:  38%|███▊      | 6817/17944 [00:05<00:08, 1274.42 examples/s]Map:  39%|███▊      | 6945/17944 [00:05<00:08, 1274.29 examples/s]Map:  39%|███▉      | 7073/17944 [00:05<00:08, 1270.85 examples/s]Map:  40%|████      | 7202/17944 [00:05<00:08, 1272.63 examples/s]Map:  41%|████      | 7331/17944 [00:05<00:08, 1272.93 examples/s]Map:  42%|████▏     | 7460/17944 [00:05<00:08, 1274.79 examples/s]Map:  42%|████▏     | 7589/17944 [00:06<00:08, 1275.72 examples/s]Map:  43%|████▎     | 7779/17944 [00:06<00:08, 1268.83 examples/s]Map:  44%|████▍     | 7908/17944 [00:06<00:07, 1270.97 examples/s]Map:  45%|████▍     | 8037/17944 [00:06<00:07, 1273.28 examples/s]Map:  46%|████▌     | 8167/17944 [00:06<00:07, 1275.92 examples/s]Map:  46%|████▌     | 8296/17944 [00:06<00:07, 1277.04 examples/s]Map:  47%|████▋     | 8486/17944 [00:06<00:07, 1270.60 examples/s]Map:  48%|████▊     | 8614/17944 [00:06<00:07, 1271.89 examples/s]Map:  49%|████▊     | 8743/17944 [00:06<00:07, 1274.59 examples/s]Map:  49%|████▉     | 8872/17944 [00:07<00:07, 1275.36 examples/s]Map:  50%|█████     | 9001/17944 [00:07<00:07, 1275.32 examples/s]Map:  51%|█████     | 9189/17944 [00:07<00:06, 1265.67 examples/s]Map:  52%|█████▏    | 9318/17944 [00:07<00:06, 1268.26 examples/s]Map:  53%|█████▎    | 9448/17944 [00:07<00:06, 1273.20 examples/s]Map:  53%|█████▎    | 9578/17944 [00:07<00:06, 1276.66 examples/s]Map:  54%|█████▍    | 9706/17944 [00:07<00:06, 1273.61 examples/s]Map:  55%|█████▌    | 9890/17944 [00:07<00:06, 1252.15 examples/s]Map:  61%|██████    | 10942/17944 [00:07<00:01, 3704.63 examples/s]Map:  72%|███████▏  | 12883/17944 [00:08<00:00, 8011.86 examples/s]Map:  82%|████████▏ | 14767/17944 [00:08<00:00, 11057.98 examples/s]Map:  93%|█████████▎| 16686/17944 [00:08<00:00, 13388.87 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2116.84 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

