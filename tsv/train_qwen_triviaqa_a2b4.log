Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 120/17944 [00:00<00:15, 1174.68 examples/s]Map:   1%|▏         | 250/17944 [00:00<00:14, 1242.51 examples/s]Map:   2%|▏         | 381/17944 [00:00<00:13, 1266.39 examples/s]Map:   3%|▎         | 511/17944 [00:00<00:13, 1277.32 examples/s]Map:   4%|▎         | 642/17944 [00:00<00:13, 1286.29 examples/s]Map:   4%|▍         | 773/17944 [00:00<00:13, 1292.07 examples/s]Map:   5%|▌         | 904/17944 [00:00<00:13, 1293.59 examples/s]Map:   6%|▌         | 1095/17944 [00:00<00:13, 1277.25 examples/s]Map:   7%|▋         | 1227/17944 [00:00<00:13, 1284.42 examples/s]Map:   8%|▊         | 1358/17944 [00:01<00:12, 1290.15 examples/s]Map:   8%|▊         | 1489/17944 [00:01<00:12, 1293.44 examples/s]Map:   9%|▉         | 1682/17944 [00:01<00:12, 1287.74 examples/s]Map:  10%|█         | 1876/17944 [00:01<00:12, 1286.08 examples/s]Map:  11%|█         | 2008/17944 [00:01<00:12, 1290.88 examples/s]Map:  12%|█▏        | 2140/17944 [00:01<00:12, 1296.18 examples/s]Map:  13%|█▎        | 2335/17944 [00:01<00:12, 1291.97 examples/s]Map:  14%|█▎        | 2467/17944 [00:01<00:11, 1295.77 examples/s]Map:  14%|█▍        | 2599/17944 [00:02<00:11, 1298.94 examples/s]Map:  15%|█▌        | 2731/17944 [00:02<00:11, 1302.05 examples/s]Map:  16%|█▋        | 2926/17944 [00:02<00:11, 1297.77 examples/s]Map:  17%|█▋        | 3116/17944 [00:02<00:11, 1283.18 examples/s]Map:  18%|█▊        | 3248/17944 [00:02<00:11, 1290.21 examples/s]Map:  19%|█▉        | 3380/17944 [00:02<00:11, 1296.37 examples/s]Map:  20%|█▉        | 3574/17944 [00:02<00:11, 1294.21 examples/s]Map:  21%|██        | 3705/17944 [00:02<00:10, 1295.51 examples/s]Map:  21%|██▏       | 3837/17944 [00:02<00:10, 1300.09 examples/s]Map:  22%|██▏       | 3969/17944 [00:03<00:10, 1303.96 examples/s]Map:  23%|██▎       | 4101/17944 [00:03<00:10, 1306.34 examples/s]Map:  24%|██▎       | 4232/17944 [00:03<00:10, 1305.10 examples/s]Map:  24%|██▍       | 4364/17944 [00:03<00:10, 1307.51 examples/s]Map:  25%|██▌       | 4496/17944 [00:03<00:10, 1310.03 examples/s]Map:  26%|██▌       | 4690/17944 [00:03<00:10, 1298.21 examples/s]Map:  27%|██▋       | 4822/17944 [00:03<00:10, 1300.11 examples/s]Map:  28%|██▊       | 4954/17944 [00:03<00:09, 1301.31 examples/s]Map:  28%|██▊       | 5086/17944 [00:03<00:09, 1302.76 examples/s]Map:  29%|██▉       | 5281/17944 [00:04<00:09, 1298.33 examples/s]Map:  30%|███       | 5412/17944 [00:04<00:09, 1300.34 examples/s]Map:  31%|███       | 5544/17944 [00:04<00:09, 1303.46 examples/s]Map:  32%|███▏      | 5676/17944 [00:04<00:09, 1305.22 examples/s]Map:  32%|███▏      | 5808/17944 [00:04<00:09, 1307.16 examples/s]Map:  33%|███▎      | 5996/17944 [00:04<00:09, 1281.56 examples/s]Map:  34%|███▍      | 6186/17944 [00:04<00:09, 1274.08 examples/s]Map:  35%|███▌      | 6318/17944 [00:04<00:09, 1283.92 examples/s]Map:  36%|███▌      | 6449/17944 [00:04<00:08, 1290.14 examples/s]Map:  37%|███▋      | 6581/17944 [00:05<00:08, 1296.75 examples/s]Map:  37%|███▋      | 6713/17944 [00:05<00:08, 1299.60 examples/s]Map:  38%|███▊      | 6845/17944 [00:05<00:08, 1303.73 examples/s]Map:  39%|███▉      | 7039/17944 [00:05<00:08, 1297.15 examples/s]Map:  40%|███▉      | 7170/17944 [00:05<00:08, 1298.69 examples/s]Map:  41%|████      | 7363/17944 [00:05<00:08, 1290.67 examples/s]Map:  42%|████▏     | 7494/17944 [00:05<00:08, 1295.16 examples/s]Map:  42%|████▏     | 7626/17944 [00:05<00:07, 1300.01 examples/s]Map:  43%|████▎     | 7758/17944 [00:05<00:07, 1303.70 examples/s]Map:  44%|████▍     | 7890/17944 [00:06<00:07, 1305.59 examples/s]Map:  45%|████▍     | 8022/17944 [00:06<00:07, 1306.62 examples/s]Map:  46%|████▌     | 8208/17944 [00:06<00:07, 1278.97 examples/s]Map:  46%|████▋     | 8339/17944 [00:06<00:07, 1284.54 examples/s]Map:  47%|████▋     | 8468/17944 [00:06<00:07, 1283.31 examples/s]Map:  48%|████▊     | 8600/17944 [00:06<00:07, 1289.41 examples/s]Map:  49%|████▊     | 8731/17944 [00:06<00:07, 1290.93 examples/s]Map:  49%|████▉     | 8863/17944 [00:06<00:07, 1294.92 examples/s]Map:  50%|█████     | 8994/17944 [00:06<00:06, 1296.14 examples/s]Map:  51%|█████     | 9126/17944 [00:07<00:06, 1298.80 examples/s]Map:  52%|█████▏    | 9257/17944 [00:07<00:06, 1299.81 examples/s]Map:  52%|█████▏    | 9388/17944 [00:07<00:06, 1300.99 examples/s]Map:  53%|█████▎    | 9572/17944 [00:07<00:06, 1265.45 examples/s]Map:  54%|█████▍    | 9762/17944 [00:07<00:06, 1263.03 examples/s]Map:  55%|█████▌    | 9893/17944 [00:07<00:06, 1273.02 examples/s]Map:  62%|██████▏   | 11078/17944 [00:07<00:01, 4072.26 examples/s]Map:  73%|███████▎  | 13124/17944 [00:07<00:00, 8568.26 examples/s]Map:  84%|████████▍ | 15127/17944 [00:07<00:00, 11794.38 examples/s]Map:  95%|█████████▌| 17134/17944 [00:08<00:00, 14167.06 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2165.18 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

