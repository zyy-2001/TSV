Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 116/17944 [00:00<00:15, 1126.17 examples/s]Map:   1%|▏         | 244/17944 [00:00<00:14, 1210.32 examples/s]Map:   2%|▏         | 373/17944 [00:00<00:14, 1240.63 examples/s]Map:   3%|▎         | 502/17944 [00:00<00:13, 1256.73 examples/s]Map:   4%|▎         | 631/17944 [00:00<00:13, 1264.19 examples/s]Map:   4%|▍         | 761/17944 [00:00<00:13, 1273.29 examples/s]Map:   5%|▍         | 891/17944 [00:00<00:13, 1278.97 examples/s]Map:   6%|▌         | 1021/17944 [00:00<00:13, 1283.10 examples/s]Map:   6%|▋         | 1151/17944 [00:00<00:13, 1285.17 examples/s]Map:   7%|▋         | 1281/17944 [00:01<00:12, 1286.13 examples/s]Map:   8%|▊         | 1411/17944 [00:01<00:12, 1285.49 examples/s]Map:   9%|▊         | 1541/17944 [00:01<00:12, 1288.52 examples/s]Map:   9%|▉         | 1670/17944 [00:01<00:12, 1288.48 examples/s]Map:  10%|█         | 1801/17944 [00:01<00:12, 1290.75 examples/s]Map:  11%|█         | 1931/17944 [00:01<00:12, 1290.82 examples/s]Map:  11%|█▏        | 2061/17944 [00:01<00:12, 1290.62 examples/s]Map:  12%|█▏        | 2191/17944 [00:01<00:12, 1291.66 examples/s]Map:  13%|█▎        | 2321/17944 [00:01<00:12, 1290.74 examples/s]Map:  14%|█▎        | 2451/17944 [00:01<00:12, 1289.87 examples/s]Map:  14%|█▍        | 2581/17944 [00:02<00:11, 1289.41 examples/s]Map:  15%|█▌        | 2712/17944 [00:02<00:11, 1291.23 examples/s]Map:  16%|█▌        | 2842/17944 [00:02<00:11, 1291.39 examples/s]Map:  17%|█▋        | 2973/17944 [00:02<00:11, 1293.21 examples/s]Map:  17%|█▋        | 3103/17944 [00:02<00:11, 1292.24 examples/s]Map:  18%|█▊        | 3234/17944 [00:02<00:11, 1292.63 examples/s]Map:  19%|█▊        | 3364/17944 [00:02<00:11, 1292.33 examples/s]Map:  20%|█▉        | 3557/17944 [00:02<00:11, 1286.79 examples/s]Map:  21%|██        | 3687/17944 [00:02<00:11, 1288.60 examples/s]Map:  21%|██▏       | 3818/17944 [00:02<00:10, 1290.44 examples/s]Map:  22%|██▏       | 4012/17944 [00:03<00:10, 1289.61 examples/s]Map:  23%|██▎       | 4142/17944 [00:03<00:10, 1290.73 examples/s]Map:  24%|██▍       | 4273/17944 [00:03<00:10, 1292.48 examples/s]Map:  25%|██▍       | 4403/17944 [00:03<00:10, 1292.12 examples/s]Map:  25%|██▌       | 4534/17944 [00:03<00:10, 1293.16 examples/s]Map:  26%|██▌       | 4665/17944 [00:03<00:10, 1293.14 examples/s]Map:  27%|██▋       | 4860/17944 [00:03<00:10, 1292.04 examples/s]Map:  28%|██▊       | 4991/17944 [00:03<00:10, 1292.48 examples/s]Map:  29%|██▊       | 5122/17944 [00:03<00:09, 1293.98 examples/s]Map:  29%|██▉       | 5252/17944 [00:04<00:09, 1294.52 examples/s]Map:  30%|███       | 5445/17944 [00:04<00:09, 1287.77 examples/s]Map:  31%|███       | 5576/17944 [00:04<00:09, 1290.07 examples/s]Map:  32%|███▏      | 5707/17944 [00:04<00:09, 1293.26 examples/s]Map:  33%|███▎      | 5837/17944 [00:04<00:09, 1293.02 examples/s]Map:  33%|███▎      | 5967/17944 [00:04<00:09, 1294.33 examples/s]Map:  34%|███▍      | 6098/17944 [00:04<00:09, 1294.24 examples/s]Map:  35%|███▍      | 6229/17944 [00:04<00:09, 1295.99 examples/s]Map:  35%|███▌      | 6360/17944 [00:04<00:08, 1297.75 examples/s]Map:  36%|███▌      | 6490/17944 [00:05<00:08, 1295.98 examples/s]Map:  37%|███▋      | 6621/17944 [00:05<00:08, 1297.69 examples/s]Map:  38%|███▊      | 6813/17944 [00:05<00:08, 1288.20 examples/s]Map:  39%|███▊      | 6944/17944 [00:05<00:08, 1291.07 examples/s]Map:  39%|███▉      | 7074/17944 [00:05<00:08, 1290.37 examples/s]Map:  40%|████      | 7205/17944 [00:05<00:08, 1293.51 examples/s]Map:  41%|████      | 7336/17944 [00:05<00:08, 1295.28 examples/s]Map:  42%|████▏     | 7468/17944 [00:05<00:08, 1297.84 examples/s]Map:  42%|████▏     | 7599/17944 [00:05<00:07, 1299.03 examples/s]Map:  43%|████▎     | 7792/17944 [00:06<00:07, 1289.50 examples/s]Map:  44%|████▍     | 7922/17944 [00:06<00:07, 1290.19 examples/s]Map:  45%|████▍     | 8054/17944 [00:06<00:07, 1293.53 examples/s]Map:  46%|████▌     | 8185/17944 [00:06<00:07, 1295.77 examples/s]Map:  46%|████▋     | 8315/17944 [00:06<00:07, 1294.59 examples/s]Map:  47%|████▋     | 8446/17944 [00:06<00:07, 1296.09 examples/s]Map:  48%|████▊     | 8576/17944 [00:06<00:07, 1296.03 examples/s]Map:  49%|████▊     | 8707/17944 [00:06<00:07, 1297.57 examples/s]Map:  49%|████▉     | 8838/17944 [00:06<00:07, 1298.56 examples/s]Map:  50%|█████     | 9031/17944 [00:07<00:06, 1290.34 examples/s]Map:  51%|█████     | 9162/17944 [00:07<00:06, 1290.35 examples/s]Map:  52%|█████▏    | 9293/17944 [00:07<00:06, 1293.03 examples/s]Map:  53%|█████▎    | 9424/17944 [00:07<00:06, 1294.50 examples/s]Map:  53%|█████▎    | 9554/17944 [00:07<00:06, 1291.57 examples/s]Map:  54%|█████▍    | 9684/17944 [00:07<00:06, 1292.07 examples/s]Map:  55%|█████▍    | 9814/17944 [00:07<00:06, 1293.57 examples/s]Map:  55%|█████▌    | 9945/17944 [00:07<00:06, 1295.38 examples/s]Map:  66%|██████▌   | 11846/17944 [00:07<00:00, 6534.98 examples/s]Map:  77%|███████▋  | 13844/17944 [00:07<00:00, 10527.99 examples/s]Map:  88%|████████▊ | 15784/17944 [00:08<00:00, 13169.49 examples/s]Map:  99%|█████████▉| 17751/17944 [00:08<00:00, 15105.79 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2157.93 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

