Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 115/17944 [00:00<00:15, 1119.43 examples/s]Map:   1%|▏         | 241/17944 [00:00<00:14, 1198.73 examples/s]Map:   2%|▏         | 368/17944 [00:00<00:14, 1228.11 examples/s]Map:   3%|▎         | 496/17944 [00:00<00:14, 1243.27 examples/s]Map:   3%|▎         | 624/17944 [00:00<00:13, 1253.27 examples/s]Map:   4%|▍         | 752/17944 [00:00<00:13, 1258.33 examples/s]Map:   5%|▍         | 880/17944 [00:00<00:13, 1261.41 examples/s]Map:   6%|▌         | 1009/17944 [00:00<00:13, 1265.87 examples/s]Map:   6%|▋         | 1138/17944 [00:00<00:13, 1268.01 examples/s]Map:   7%|▋         | 1267/17944 [00:01<00:13, 1269.92 examples/s]Map:   8%|▊         | 1395/17944 [00:01<00:13, 1271.28 examples/s]Map:   8%|▊         | 1523/17944 [00:01<00:12, 1271.02 examples/s]Map:   9%|▉         | 1652/17944 [00:01<00:12, 1274.63 examples/s]Map:  10%|▉         | 1781/17944 [00:01<00:12, 1275.93 examples/s]Map:  11%|█         | 1909/17944 [00:01<00:12, 1275.73 examples/s]Map:  11%|█▏        | 2039/17944 [00:01<00:12, 1280.58 examples/s]Map:  12%|█▏        | 2169/17944 [00:01<00:12, 1281.39 examples/s]Map:  13%|█▎        | 2299/17944 [00:01<00:12, 1282.59 examples/s]Map:  14%|█▍        | 2492/17944 [00:01<00:12, 1279.19 examples/s]Map:  15%|█▍        | 2621/17944 [00:02<00:11, 1279.99 examples/s]Map:  16%|█▌        | 2813/17944 [00:02<00:11, 1272.82 examples/s]Map:  16%|█▋        | 2942/17944 [00:02<00:11, 1274.68 examples/s]Map:  17%|█▋        | 3120/17944 [00:02<00:11, 1239.65 examples/s]Map:  18%|█▊        | 3250/17944 [00:02<00:11, 1251.56 examples/s]Map:  19%|█▉        | 3379/17944 [00:02<00:11, 1258.51 examples/s]Map:  20%|█▉        | 3509/17944 [00:02<00:11, 1266.46 examples/s]Map:  20%|██        | 3637/17944 [00:02<00:11, 1265.27 examples/s]Map:  21%|██        | 3766/17944 [00:02<00:11, 1270.58 examples/s]Map:  22%|██▏       | 3958/17944 [00:03<00:10, 1272.43 examples/s]Map:  23%|██▎       | 4086/17944 [00:03<00:10, 1271.59 examples/s]Map:  23%|██▎       | 4216/17944 [00:03<00:10, 1275.58 examples/s]Map:  24%|██▍       | 4346/17944 [00:03<00:10, 1279.64 examples/s]Map:  25%|██▍       | 4475/17944 [00:03<00:10, 1277.51 examples/s]Map:  26%|██▌       | 4605/17944 [00:03<00:10, 1279.33 examples/s]Map:  26%|██▋       | 4734/17944 [00:03<00:10, 1279.72 examples/s]Map:  27%|██▋       | 4863/17944 [00:03<00:10, 1280.43 examples/s]Map:  28%|██▊       | 4992/17944 [00:03<00:10, 1280.36 examples/s]Map:  29%|██▉       | 5183/17944 [00:04<00:10, 1274.58 examples/s]Map:  30%|██▉       | 5312/17944 [00:04<00:09, 1277.53 examples/s]Map:  30%|███       | 5442/17944 [00:04<00:09, 1281.26 examples/s]Map:  31%|███       | 5572/17944 [00:04<00:09, 1283.34 examples/s]Map:  32%|███▏      | 5703/17944 [00:04<00:09, 1287.25 examples/s]Map:  33%|███▎      | 5894/17944 [00:04<00:09, 1279.25 examples/s]Map:  34%|███▎      | 6024/17944 [00:04<00:09, 1280.20 examples/s]Map:  34%|███▍      | 6154/17944 [00:04<00:09, 1282.97 examples/s]Map:  35%|███▌      | 6284/17944 [00:04<00:09, 1284.75 examples/s]Map:  36%|███▌      | 6414/17944 [00:05<00:08, 1286.52 examples/s]Map:  36%|███▋      | 6544/17944 [00:05<00:08, 1288.53 examples/s]Map:  37%|███▋      | 6673/17944 [00:05<00:08, 1287.21 examples/s]Map:  38%|███▊      | 6802/17944 [00:05<00:08, 1277.58 examples/s]Map:  39%|███▊      | 6930/17944 [00:05<00:08, 1277.55 examples/s]Map:  39%|███▉      | 7060/17944 [00:05<00:08, 1279.59 examples/s]Map:  40%|████      | 7190/17944 [00:05<00:08, 1282.90 examples/s]Map:  41%|████      | 7320/17944 [00:05<00:08, 1285.58 examples/s]Map:  42%|████▏     | 7450/17944 [00:05<00:08, 1286.52 examples/s]Map:  42%|████▏     | 7580/17944 [00:05<00:08, 1287.98 examples/s]Map:  43%|████▎     | 7710/17944 [00:06<00:07, 1288.54 examples/s]Map:  44%|████▎     | 7839/17944 [00:06<00:07, 1287.16 examples/s]Map:  44%|████▍     | 7968/17944 [00:06<00:07, 1286.72 examples/s]Map:  45%|████▌     | 8160/17944 [00:06<00:07, 1277.60 examples/s]Map:  46%|████▌     | 8289/17944 [00:06<00:07, 1279.17 examples/s]Map:  47%|████▋     | 8419/17944 [00:06<00:07, 1281.50 examples/s]Map:  48%|████▊     | 8549/17944 [00:06<00:07, 1283.52 examples/s]Map:  48%|████▊     | 8679/17944 [00:06<00:07, 1285.10 examples/s]Map:  49%|████▉     | 8809/17944 [00:06<00:07, 1286.93 examples/s]Map:  50%|████▉     | 8939/17944 [00:07<00:07, 1286.41 examples/s]Map:  51%|█████     | 9069/17944 [00:07<00:06, 1285.88 examples/s]Map:  51%|█████▏    | 9199/17944 [00:07<00:06, 1286.30 examples/s]Map:  52%|█████▏    | 9328/17944 [00:07<00:06, 1285.07 examples/s]Map:  53%|█████▎    | 9457/17944 [00:07<00:06, 1285.35 examples/s]Map:  53%|█████▎    | 9586/17944 [00:07<00:06, 1283.04 examples/s]Map:  54%|█████▍    | 9715/17944 [00:07<00:06, 1283.50 examples/s]Map:  55%|█████▍    | 9845/17944 [00:07<00:06, 1284.81 examples/s]Map:  56%|█████▋    | 10106/17944 [00:07<00:04, 1679.26 examples/s]Map:  67%|██████▋   | 12064/17944 [00:07<00:00, 7023.58 examples/s]Map:  78%|███████▊  | 14051/17944 [00:08<00:00, 10863.21 examples/s]Map:  89%|████████▉ | 15980/17944 [00:08<00:00, 13382.89 examples/s]Map: 100%|█████████▉| 17921/17944 [00:08<00:00, 15185.86 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2132.05 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

