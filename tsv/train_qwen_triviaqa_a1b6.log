Map:   0%|          | 0/17944 [00:00<?, ? examples/s]Map:   1%|          | 119/17944 [00:00<00:15, 1162.78 examples/s]Map:   1%|▏         | 249/17944 [00:00<00:14, 1239.30 examples/s]Map:   2%|▏         | 379/17944 [00:00<00:13, 1259.28 examples/s]Map:   3%|▎         | 509/17944 [00:00<00:13, 1272.63 examples/s]Map:   4%|▎         | 638/17944 [00:00<00:13, 1275.94 examples/s]Map:   4%|▍         | 769/17944 [00:00<00:13, 1283.17 examples/s]Map:   5%|▌         | 900/17944 [00:00<00:13, 1286.62 examples/s]Map:   6%|▌         | 1031/17944 [00:00<00:13, 1289.55 examples/s]Map:   6%|▋         | 1162/17944 [00:00<00:12, 1293.46 examples/s]Map:   7%|▋         | 1293/17944 [00:01<00:12, 1296.06 examples/s]Map:   8%|▊         | 1425/17944 [00:01<00:12, 1298.96 examples/s]Map:   9%|▊         | 1556/17944 [00:01<00:12, 1298.67 examples/s]Map:   9%|▉         | 1688/17944 [00:01<00:12, 1299.67 examples/s]Map:  10%|█         | 1819/17944 [00:01<00:12, 1300.32 examples/s]Map:  11%|█         | 1950/17944 [00:01<00:12, 1301.37 examples/s]Map:  12%|█▏        | 2081/17944 [00:01<00:12, 1300.38 examples/s]Map:  12%|█▏        | 2213/17944 [00:01<00:12, 1301.96 examples/s]Map:  13%|█▎        | 2344/17944 [00:01<00:11, 1301.80 examples/s]Map:  14%|█▍        | 2476/17944 [00:01<00:11, 1302.91 examples/s]Map:  15%|█▍        | 2608/17944 [00:02<00:11, 1303.90 examples/s]Map:  15%|█▌        | 2740/17944 [00:02<00:11, 1304.11 examples/s]Map:  16%|█▌        | 2872/17944 [00:02<00:11, 1303.04 examples/s]Map:  17%|█▋        | 3003/17944 [00:02<00:11, 1302.46 examples/s]Map:  17%|█▋        | 3134/17944 [00:02<00:11, 1302.30 examples/s]Map:  18%|█▊        | 3265/17944 [00:02<00:11, 1300.56 examples/s]Map:  19%|█▉        | 3458/17944 [00:02<00:11, 1289.07 examples/s]Map:  20%|██        | 3590/17944 [00:02<00:11, 1293.84 examples/s]Map:  21%|██        | 3721/17944 [00:02<00:10, 1296.74 examples/s]Map:  21%|██▏       | 3853/17944 [00:02<00:10, 1299.30 examples/s]Map:  22%|██▏       | 3984/17944 [00:03<00:10, 1299.99 examples/s]Map:  23%|██▎       | 4115/17944 [00:03<00:10, 1299.79 examples/s]Map:  24%|██▎       | 4246/17944 [00:03<00:10, 1300.74 examples/s]Map:  24%|██▍       | 4378/17944 [00:03<00:10, 1301.86 examples/s]Map:  25%|██▌       | 4510/17944 [00:03<00:10, 1302.93 examples/s]Map:  26%|██▌       | 4641/17944 [00:03<00:10, 1302.73 examples/s]Map:  27%|██▋       | 4773/17944 [00:03<00:10, 1303.48 examples/s]Map:  27%|██▋       | 4905/17944 [00:03<00:09, 1304.86 examples/s]Map:  28%|██▊       | 5100/17944 [00:03<00:09, 1300.15 examples/s]Map:  29%|██▉       | 5231/17944 [00:04<00:09, 1300.54 examples/s]Map:  30%|██▉       | 5363/17944 [00:04<00:09, 1302.68 examples/s]Map:  31%|███       | 5495/17944 [00:04<00:09, 1305.35 examples/s]Map:  31%|███▏      | 5626/17944 [00:04<00:09, 1304.51 examples/s]Map:  32%|███▏      | 5758/17944 [00:04<00:09, 1305.40 examples/s]Map:  33%|███▎      | 5889/17944 [00:04<00:09, 1301.74 examples/s]Map:  34%|███▎      | 6021/17944 [00:04<00:09, 1302.56 examples/s]Map:  34%|███▍      | 6152/17944 [00:04<00:09, 1303.76 examples/s]Map:  35%|███▌      | 6284/17944 [00:04<00:08, 1304.99 examples/s]Map:  36%|███▌      | 6415/17944 [00:04<00:08, 1303.57 examples/s]Map:  36%|███▋      | 6546/17944 [00:05<00:08, 1303.01 examples/s]Map:  37%|███▋      | 6678/17944 [00:05<00:08, 1305.11 examples/s]Map:  38%|███▊      | 6809/17944 [00:05<00:08, 1303.49 examples/s]Map:  39%|███▊      | 6940/17944 [00:05<00:08, 1303.32 examples/s]Map:  39%|███▉      | 7072/17944 [00:05<00:08, 1304.93 examples/s]Map:  40%|████      | 7204/17944 [00:05<00:08, 1306.04 examples/s]Map:  41%|████      | 7335/17944 [00:05<00:08, 1305.89 examples/s]Map:  42%|████▏     | 7466/17944 [00:05<00:08, 1305.03 examples/s]Map:  43%|████▎     | 7662/17944 [00:05<00:07, 1300.92 examples/s]Map:  43%|████▎     | 7794/17944 [00:06<00:07, 1303.51 examples/s]Map:  44%|████▍     | 7925/17944 [00:06<00:07, 1303.81 examples/s]Map:  45%|████▍     | 8056/17944 [00:06<00:07, 1302.66 examples/s]Map:  46%|████▌     | 8187/17944 [00:06<00:07, 1302.57 examples/s]Map:  46%|████▋     | 8319/17944 [00:06<00:07, 1304.29 examples/s]Map:  47%|████▋     | 8451/17944 [00:06<00:07, 1305.83 examples/s]Map:  48%|████▊     | 8583/17944 [00:06<00:07, 1306.42 examples/s]Map:  49%|████▉     | 8777/17944 [00:06<00:07, 1297.12 examples/s]Map:  50%|████▉     | 8908/17944 [00:06<00:06, 1298.72 examples/s]Map:  50%|█████     | 9040/17944 [00:06<00:06, 1302.06 examples/s]Map:  51%|█████     | 9172/17944 [00:07<00:06, 1304.30 examples/s]Map:  52%|█████▏    | 9303/17944 [00:07<00:06, 1304.39 examples/s]Map:  53%|█████▎    | 9434/17944 [00:07<00:06, 1303.71 examples/s]Map:  53%|█████▎    | 9566/17944 [00:07<00:06, 1305.87 examples/s]Map:  54%|█████▍    | 9698/17944 [00:07<00:06, 1304.80 examples/s]Map:  55%|█████▍    | 9830/17944 [00:07<00:06, 1305.42 examples/s]Map:  56%|█████▋    | 10101/17944 [00:07<00:04, 1719.28 examples/s]Map:  67%|██████▋   | 12037/17944 [00:07<00:00, 6958.58 examples/s]Map:  78%|███████▊  | 14055/17944 [00:07<00:00, 10895.49 examples/s]Map:  89%|████████▉ | 15992/17944 [00:07<00:00, 13422.12 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 15160.52 examples/s]Map: 100%|██████████| 17944/17944 [00:08<00:00, 2174.32 examples/s] 
Traceback (most recent call last):
  File "tsv_main2.py", line 692, in <module>
    main()
  File "tsv_main2.py", line 580, in main
    model = AutoModelForCausalLM.from_pretrained(model_name_or_path, low_cpu_mem_usage=True, torch_dtype=torch.float16, device_map="auto", token = '')
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/transformers/modeling_utils.py", line 3834, in from_pretrained
    max_memory = get_balanced_memory(
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 731, in get_balanced_memory
    max_memory = get_max_memory(max_memory)
  File "/data/zyy/miniforge3/envs/tsv/lib/python3.8/site-packages/accelerate/utils/modeling.py", line 624, in get_max_memory
    _ = torch.tensor([0], device=i)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

